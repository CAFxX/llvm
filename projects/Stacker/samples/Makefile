##===- projects/sample/Makefile ----------------------------*- Makefile -*-===##
#
# This is a sample Makefile for a project that uses LLVM.
#
##===----------------------------------------------------------------------===##

#
# Indicates our relative path to the top of the project's root directory.
#
LEVEL = ../../..

#
# Directories that needs to be built.
#
DIRS = 

SAMPLES = fibonacci hello prime

LLVMC_EXEC = $(TOOLDIR)/llvmc

all :: $(SAMPLES)

ifdef OPTIMIZE
% : %.st 
	@$(ECHO) "Compiling and Optimizing $(<F)"
	$(VERB)$(LLVMC_EXEC) -O3 $< -o $@
else
% : %.st
	@$(ECHO) "Compiling $(<F)"
	$(VERB)$(LLVMC_EXEC) $< -o $@
endif

SAMPLES_LL = $(SAMPLES:%=%.ll)
SAMPLES_BC = $(SAMPLES:%=%.bc)
SAMPLES_S  = $(SAMPLES:%=%.s)

clean ::
	$(VERB)rm -f gmon.out $(SAMPLES)
#
# Include the Master Makefile that knows how to build all.
#
include $(LEVEL)/Makefile.common
